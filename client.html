<!DOCTYPE html>
<html>
   <head>
      <script src="/socket.io/socket.io.js"></script>
      <script src = "login.js"></script>
      <script src = 'register.js'></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script type ="text/javascript">

      var socketio = io.connect();
      socketio.on("message_to_client",function(data) {
         //Append an HR thematic break and the escaped HTML of the new message
         document.getElementById("chatlog").appendChild(document.createElement("hr"));
         document.getElementById("chatlog").appendChild(document.createTextNode(data['message']));
      });

      function sendMessage(){
         var msg = document.getElementById("message_input").value;
         socketio.emit("message_to_server", {message:msg});
      }
      
                

      </script>
   </head>
   <body>
    <div class="login_popup">
        <div class="login_popup content">
            <p>Login</p>
            <br><br>
            <input type='text' id='user' placeholder='Username' required />
            <input type='password' id='pass' placeholder='Password' required /> <br>
            <button class='login_button' id='login_button_user' name='user_type' value='user'> Login </button>
            <div id='incorrect_password'></div>
            <script src='ajax_login.js'> </script>
        </div>
    </div>  

    <div id="messaging_stuff">
      <input type="text" id="message_input"/>
      <button id = 'send_message'>send</button> <br>
      <div id="chatlog"></div>
    </div>


    <div id = 'rooms_stuff'>
        <button id = 'create_room'>Create new room</button>
        <input type="text" id="new_room_name" placeholder = 'room name'/> <br>

        <label>Room List</label><ul id = 'room_list'>
            <!-- Populate using jQuery -->
            <li class = 'room_name'>Room Name</li>
        </ul>
    </div> 
      




      <script> 
        $('#login_button_user').click(function() {
                loginAjax();
            })

        $('.room_name').click(function() {
            // Send to chat room
        })

        function createRoom(){
            let room_name = $('#new_room_name').val();
            console.log(room_name);
            socketio.emit('create', {room_name: room_name, message: 'you created a new room!'});
        }


        $("#send_message").click(function() {
            sendMessage();
        })
        $("#create_room").click(function() {
            createRoom();
        })

        $(document).ready(function() {
            // $('#rooms_stuff').hide();
            // $('#messaging_stuff').hide();
            //Implement when we have login/register working
            
        });



    </script>
   </body>
</html>